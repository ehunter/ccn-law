function triggerTextUpdate(inst){var $intro=jQuery(".kws_form .cc_intro");if($intro.length>0){var ed=tinyMCE.activeEditor,content=ed.getContent({format:"raw"});$intro.html(content)}}function empty(mixed_var){var key;if(0===mixed_var||"0"===mixed_var)return!1;if(""===mixed_var||null===mixed_var||mixed_var===!1||"false"===mixed_var||"undefined"==typeof mixed_var)return!0;if("object"==typeof mixed_var){for(key in mixed_var)return!1;return!0}return!1}jQuery.noConflict(),kwsdebug=empty(ScriptParams.debug),jQuery(document).ready(function($){function cc_create_slider(target_input_id,css_parameter,min,max,step){var $tt=$('label[for="'+target_input_id.replace("#","")+'"] tt');kwsdebug&&console.log(target_input_id+"-slider",target_input_id,css_parameter,min,max,step),$(target_input_id+"-slider").slider({min:min,max:max,step:step,value:$(target_input_id).val(),slide:function(event,ui){$tt.text(ui.value+"px"),$("#examplewrapper").find(".kws_form").css(css_parameter,ui.value)},stop:function(event,ui){$(target_input_id).val(ui.value).trigger("change")}})}function useDesign(){return $("#toggledesign").is(":checked")}function toggleDesign(dont_generate_form){$designdivs=$("#designoptions,#backgroundoptions,#border,#fontstyles,#formdesign,.grabber,#examplewrapper,.labelStyle.mce_bold,.labelStyle.mce_italic"),$(".safesubscribesample").css("background","transparent none"),useDesign()?($designdivs.show(),empty(dont_generate_form)&&generateForm()):$designdivs.hide()}function updatePattern($clickedLI){var val="";empty($clickedLI)&&($("ul#patternList li.selected").length>0?($clickedLI=$("ul#patternList li.selected"),val=$clickedLI.attr("title")):(val=$("#patternurl").val(),empty(val)&&(val=$("#bgpattern ul li.selected").length>0?$("#bgpattern ul li.selected").attr("title"):$("#bgpattern ul li:first").attr("title")),$clickedLI=$('ul#patternList li[title*="'+val+'"]'))),$("ul#patternList li").removeClass("selected"),$clickedLI.addClass("selected");var url=$clickedLI.attr("title");$("#patternurl").val(url),updateBackgroundURL(ScriptParams.path+url)}function generateForm(from){if(kwsdebug&&console.log("generateForm",from),!useDesign()||$("#togglePreview").is(".hidden"))return void(kwsdebug&&console.log("No form was generated; design not being used or preview is hidden"));$("ul.menu li.formfield").find("input,textarea").prop("disabled",!0),$("#formfields_select").find("input[type=checkbox]:checked").each(function(){$("input,textarea",$("ul.menu li.formfield").has("input#"+$(this).val())).removeAttr("disabled")});var ajaxTime=(new Date).getTime(),date=Date.now(),verify=ScriptParams.rand+$("#cc-form-id").val()+date,post_data={rand:ScriptParams.rand,form:$("form#cc-form-settings").serializeArray(),verify:verify,date:date,text:ScriptParams.text,path:ScriptParams.path};kwsdebug&&console.log("post_data sent to AJAX request: ",post_data);var $kws_form=$(".grabber .kws_form"),$spinner=$("#ctct-loading-spinner");return $.ajax({type:"POST",url:ajaxurl+"?action=ctct_form_designer",processData:!1,contentType:"application/json",isLocal:!0,dataType:"json",data:JSON.stringify(post_data),timeout:15e3,async:!0,beforeSend:function(){$kws_form.addClass("ctct-loading").addClass("ctct-loading-"+ajaxTime),$spinner.css("visibility","visible"),$("#form-fields").find("ul.menu").sortable("refreshPositions")},success:function(data,textStatus,XMLHttpRequest){return ctct_process_ajax_success(data,textStatus,XMLHttpRequest)},error:function(XMLHttpRequest,textStatus,errorThrown){return kwsdebug&&console.log(XMLHttpRequest,textStatus,errorThrown),$(".grabber").html('<div class="ctct-ajax-error"><h2><em>Eeep! That didn\'t work...</em></h2><h3>The error: <code>'+errorThrown+"</code></h3></div>").show(),!1}}).done(function(data,textStatus,XMLHttpRequest){$kws_form.removeClass("ctct-loading-"+ajaxTime),0===$kws_form.filter("[class*=ctct-loading-]").length&&($kws_form.removeClass("ctct-loading"),$spinner.css("visibility","hidden"));var totalTime=(new Date).getTime()-ajaxTime;kwsdebug&&console.log("request took %s milliseconds. Status: %s. Data: %s",totalTime,textStatus,data)}),!1}function ctct_process_ajax_success(data,textStatus,XMLHttpRequest){if(data){var html=!1;if("string"==typeof data&&(data=jQuery.parseJSON(data)),kwsdebug&&console.log("AJAX Data Response",data),empty(data.pre)||$("body").prepend(data.pre),!empty(data.form)){html=data.css+data.form;var lists=getPreviewListsInput();html=html.replace("<!-- %%LISTSELECTION%% -->",lists),html=html.replace('action="<!-- %%ACTION%% -->"','onsubmit="return false;"'),$(".grabber .kws_form, .grabber style, .grabber .ctct-ajax-error").remove(),$(".grabber").append(html),empty(lists)&&$(".grabber .cc_lists").hide()}return!0}return!1}function getPreviewListsInput(){var lists="",$lists_settings=$(".ctct-lists");kwsdebug&&console.log(".ctct-lists",$lists_settings);var format=$(".list-selection-format input:checked").val();switch(format){case"checkbox":$lists_settings.find("li").has("input:checked").each(function(){checked=$("#checked_by_default").is(":checked")?' checked="checked"':"",lists=lists+'<li><label><input type="checkbox" '+checked+" /> "+$(this).text()+"</label></li>"}),lists='<ul class="checkboxes">'+lists+"</ul>";break;case"dropdown":case"multiselect":$lists_settings.find("li").has("input:checked").each(function(){lists=lists+"<option>"+$("label",$(this)).text()+"</option>"}),lists="multiselect"===format?'<select class="kws_clear" multiple="multiple">'+lists+"</select>":'<select class="kws_clear">'+lists+"</select>"}return lists}function eventKeys(e){var code=e.keyCode?e.keyCode:e.which;return 37!==code&&38!==code&&39!==code&&40!==code&&46!==code&&8!==code&&16!==code}function updateWidthCalculator(){if("px"===$("input[name=widthtype]:checked").val()){var borderwidth=2*$("#borderwidth").val(),paddingwidth=2*$("#paddingwidth").val(),rawwidth=$("#width").val(),setwidth=Math.floor(rawwidth)-Math.floor(paddingwidth)-Math.floor(borderwidth),realwidth=Math.floor(rawwidth)+Math.floor(paddingwidth)+Math.floor(borderwidth);$("label[for=width] span.ctct_tip").attr("title","<p><strong>Actual width is "+realwidth+"px.</strong> <em>For an form that is "+rawwidth+"px wide, set Form Width to "+setwidth+"px</em></p>").tooltip()}else $("label[for=width] span.ctct_tip").attr("title","<p><strong>Width depends on the size of the container.</strong> For example, for a form in a sidebar, the form's width percentage will be based on the width of the sidebar.</p>")}function ctctSortFields(a,b){return $input_a=$("input.position",$(a)).val(),$input_b=$("input.position",$(b)).val(),0===$input_a.length||0===$input_b.length?0:$input_a>$input_b?1:-1}function sortFieldMenu(){$("#form-fields").find("ul.menu li.menu-item").sort(ctctSortFields).appendTo("#form-fields ul.menu")}function showHideFormFields($clicked){$clicked?kwsdebug&&console.log($clicked):$clicked=$("#formfields_select input:checkbox"),$clicked.each(function(){var targetLI=$("#form-fields").find(".menu li").has("#"+$(this).val()),checked=$(this).checked||$(this).prop("checked")||$(this).is(":checked");empty(checked)?("intro"===$clicked.val()&&$(".wp-editor-textarea").hide(),targetLI.hide().find("input.checkbox").prop("checked",checked).find("input,textarea").each(function(){$(this).attr("disabled",!0)})):("intro"===$clicked.val()&&$(".wp-editor-textarea").show(),targetLI.remove().appendTo($(".menu","#form-fields")).show(),targetLI.find("input,textarea").each(function(){$(this).removeAttr("disabled")}).find("input.checkbox").prop("checked",checked))})}function updateFormFields(from){from=from||"",kwsdebug&&console.log("updateFormFields",from),$(".wp-editor-textarea,ul.menu li.formfield").each(function(){updateFormField($(this))}),generateForm("updateFormFields: "+from)}function updateFormField($item){$item.not("li")&&($item=$item.parents("li.formfield"));var checkbox=$("input.checkbox",$item);if(checkbox.is(":checked")){if($(".menu-item-settings",$item).show(),check={id:checkbox.attr("id"),val:checkbox.val(),name:checkbox.attr("name"),rel:checkbox.attr("rel")},input={textarea:"",label:"",value:"",html:"",bold:"",italic:"",required:"",labelHTML:"",size:$("input.labelSize",$item).val()},kwsdebug&&console.log("check: %s, input: %s",check,input),$("input.labelValue",$item).length>0){var tempInput=$("input.labelValue",$item);input.label=tempInput.val()}("textarea"===check.rel||$item.hasClass("wp-editor")||$("textarea.labelValue",$item).length>0||$("body.mceContentBody",$item).length>0)&&(input.textarea=!0),$item.addClass("checked").addClass("ui-state-active"),$("input.labelDefault",$item).length>0?input.value=$("input.labelDefault",$item).val():empty(tinyMCE)&&(input.value=$("textarea.labelDefault",$item).html()),$("#"+check.id+"_bold").is(":checked")&&(input.bold=!0),$("#"+check.id+"_italic").is(":checked")&&(input.italic=!0),$("#"+check.id+"_required").is(":checked")&&(input.required=!0),"text"===check.rel&&(input.html='<input type="text" value="'+input.value+'" size="'+input.size+'" name="'+check.name+'" class="text" id="cc_'+check.id+'" />'),"button"!==check.rel&&"submit"!==check.rel||(input.html='<input type="submit" value="'+input.value+'" name="'+check.name+'" id="cc_'+check.id+'" />'),"textarea"===check.rel&&(input.html=$("<textarea>"+input.value+"</textarea>").attr("name",check.name).attr("id",check.id).removeAttr("disabled"))}else $item.removeClass("checked").removeClass("ui-state-active")}function updateSortOrder(){$("ul.menu li.formfield","#cc-form-settings").each(function(){$("input.position[type=hidden]",$(this)).val($("ul.menu li.formfield input.position").index($("input.position",$(this))))})}function updateSharedVars(ui){prev=ui.placeholder.prev(),next=ui.placeholder.next(),prev[0]===ui.item[0]&&(prev=prev.prev()),next[0]===ui.item[0]&&(next=next.next())}function updateLabelStyle(textfont,textsize,fontweight,textpadding,textalign){textfont||(textfont=$('input[name="lfont"]').val()),textsize||(textsize=$('input[name="lsize"]').val()),fontweight||(fontweight=""),textpadding||(textpadding=$('input[name="lpad"]').val()),textalign||(textalign=$('input[name="lalign"]').val()),updateTextStyle(textfont,textsize,fontweight,textpadding,textalign,"l")}function updateTextStyle(textfont,textsize,fontweight,textpadding,textalign,prefix){kwsdebug&&console.log("updateTextStyle",textfont,textsize,fontweight,textpadding,textalign,prefix),empty(prefix)&&(prefix="t"),empty(textfont)?textfont=$("#"+prefix+"font").val():(textfont=$('select[name="'+prefix+'font"] option[id="'+textfont+'"]').val(),$('select[name="'+prefix+'font"] option[value="'+textfont+'"]').prop("selected",!0)),empty(textsize)?textsize=$("#"+prefix+"size").val():$("select#"+prefix+'size option[value="'+textsize+'"]').prop("selected",!0),empty(textalign)&&(textalign=$('input[name="'+prefix+'align"]').val()),empty(fontweight)?fontweight=$('input[name="'+prefix+'weight"]').val():$('input[name="'+prefix+'weight"][value="'+fontweight+'"]').prop("checked",!0),$('option:selected:contains("*")',"#textfont").length>0?$("#"+prefix+"options .asterix").show():$("#"+prefix+"options .asterix").hide()}function updateBorderWidth(borderwidth){empty(borderwidth)||$("#borderwidth").val(borderwidth),borderwidth=$("#borderwidth").val(),empty(borderwidth)?$("#bordercoloritem").hide():$("#bordercoloritem").show(),$(".kws_form").css({"border-width":borderwidth+"px"})}function updateBackgroundType(from){kwsdebug&&console.log("updateBackgroundType"+from),color1=$("#color6").wpColorPicker("color"),color2=$("#color2").wpColorPicker("color"),gradtype=$("#gradtype").val();var selection=$("input[name=backgroundtype]:checked").val();"transparent"===selection?($("#bgtop,#bgbottom,#gradtype,#bgrepeat,#bgpos,#bgpattern,#patternurl,#bgurl,#color2,#gradheightli,#gradtypeli").attr("disabled",!0).hide(),$(".safesubscribesample").css("background","none transparent"),$(".kws_form").css("background","transparent none")):"gradient"===selection?($("#bgtop,#bgbottom,#gradtype,#bgrepeat,#bgpos,#bgpattern,#patternurl,#bgurl,#color2,#gradheightli,#gradtypeli").attr("disabled",!1).show(),$("#bgpattern,#bgurl").hide(),$("#patternurl,#bgimage").attr("disabled",!0),$("#color2,#gradtype,#bgrepeat,#bgpos").removeAttr("disabled"),updateColor("#color6",color1),updateColor("#color2",color2),$(".safesubscribesample").css("background",color1+" none"),"vertical"===$("#gradtype").val()?($("label","#bgbottom").text(ScriptParams.labels.bottomcolor+":"),$("label","#bgtop").text(ScriptParams.labels.topcolor+":"),$("label span","#gradheightli").text(ScriptParams.labels.gradientheight+":"),$(".kws_form").css({background:color1,background:"-moz-linear-gradient(top, "+color1+" 0%, "+color2+" 100%)",background:"-webkit-gradient(linear, left top, left bottom, color-stop(0%,"+color1+"), color-stop(100%,"+color2+"))",background:"-webkit-linear-gradient(top, "+color1+" 0%,"+color2+" 100%)",background:"-o-linear-gradient(top, "+color1+" 0%,"+color2+" 100%)",background:"-ms-linear-gradient(top, "+color1+" 0%,"+color2+" 100%)",background:"linear-gradient(to bottom, "+color1+" 0%,"+color2+" 100%)",filter:"progid:DXImageTransform.Microsoft.gradient( startColorstr='"+color1+"', endColorstr='"+color2+"',GradientType=0 )"})):($("label","#bgbottom").text(ScriptParams.labels.rightcolor+":"),$("label","#bgtop").text(ScriptParams.labels.leftcolor+":"),$("label span","#gradheightli").text(ScriptParams.labels.gradientwidth+":"),$(".kws_form").css({background:color1,background:"-moz-linear-gradient(left,  "+color1+" 0%, "+color2+" 100%)",background:"-webkit-gradient(linear, left top, right top, color-stop(0%,"+color1+"), color-stop(100%,"+color2+"))",background:"-webkit-linear-gradient(left,  "+color1+" 0%,"+color2+" 100%)",background:"-o-linear-gradient(left, "+color1+" 0%,"+color2+" 100%)",background:"-ms-linear-gradient(left, "+color1+" 0%,"+color2+" 100%)",background:"linear-gradient(to right,  "+color1+" 0%, "+color2+" 100%)",filter:"progid:DXImageTransform.Microsoft.gradient( startColorstr='"+color1+"', endColorstr='"+color2+"',GradientType=1 )"}))):"solid"===selection?($("#bgtop,#gradheightli,#gradtypeli,#bgpattern,#bgurl").hide(),$("#bgbottom").show().find("label").text(ScriptParams.labels.bgcolor+":"),$("#patternurl,#bgimage,#gradtype,#bgrepeat,#bgpos").attr("disabled",!0),$("#color2").removeAttr("disabled"),updateColor("#color6",color1),updateColor("#color2",color2),$(".kws_form,.safesubscribesample").css("background-color",color2).css("background-image","none")):"pattern"===selection?($("#bgtop,#gradheightli,#gradtypeli,#bgbottom,#bgurl").hide(),$("#bgpattern").show(),$("#color2,#bgimage").attr("disabled",!0),$("#bgpattern,#patternurl,#bgrepeat,#bgpos").removeAttr("disabled"),updatePattern()):"url"===selection&&($("#patternurl").attr("disabled",!0),$("#color2,#bgimage,#bgrepeat,#bgpos").removeAttr("disabled"),$("#bgtop,#gradheightli,#bgpattern").hide(),$("#bgurl,#bgbottom").show(),$("label","#bgbottom").text(ScriptParams.labels.bgcolor+":"),updateBackgroundURL())}function updateBackgroundURL(url,color,repeat,position){empty(repeat)&&(repeat=$("#bgrepeat").val()),empty(url)&&(url=$("input#bgimage").val()),url=""===url||"http://"===url?"":"url("+url+")",empty(color)&&(color=$("#color2").wpColorPicker("color")),empty(position)&&(position=$("#bgpos").val()),$(".kws_form,.safesubscribesample").css("background",color+" "+url+" "+position+" "+repeat)}function updateLabelSame(set){kwsdebug&&console.log("updateLabelSame",set);var $lusc=$("#lusc"),$labelcolor=$("#labelcolorli");$lusc.prop("checked",set),$lusc.is(":checked")?($labelcolor.hide(),$("input",$labelcolor).attr("disabled",!0)):($labelcolor.show(),$("input",$labelcolor).removeAttr("disabled")),$("input#lusf").is(":checked")?($("#lfontli").hide(),$("#lfont").val($("#tfont").val())):$("#lfontli").show()}function updateLabelColor(color){kwsdebug&&console.log("updateLabelColor",color),color||(color=$("#lcolor").wpColorPicker("color")),updateColor("#lcolor",color,".kws_form .kws_input_container label","color")}function updateTextColor(color){kwsdebug&&console.log("updateTextColor: "+color),color||(color=$("#tcolor").wpColorPicker("color")),updateColor("#tcolor",color,".kws_form .cc_intro,.kws_form .cc_intro *","color"),$("#lusc").is(":checked")&&updateLabelColor(color)}function updateBorderColor(color){kwsdebug&&console.log("updateBorderColor",color),empty(color)&&(color=$("#bordercolor").wpColorPicker("color")),updateColor("#bordercolor",color,".kws_form","border-color")}function updateColor(target,color,formelement,formcssattr){kwsdebug&&console.log("updateColor",target,color,formelement,formcssattr),$(target).val(color),formcssattr&&$(formelement).css(formcssattr,color)}function updateStyle(){kwsdebug&&console.log("updateStyle"),updateBackgroundType("updateStyle"),updateTextStyle(),updateLabelStyle(),updateLabelSame(),$("label.labelStyle").trigger("ready")}$("a[rel*=external]").attr("target","_blank"),$("input.wpcolor").wpColorPicker({palettes:!1,change:function(event,ui){kwsdebug&&console.log("wpColorPicker Change",event),$(this).data("doingchange",1),$(this).trigger("colorchange"),$(this).data("doingchange",null)}}),$("#delete_all_forms").appendTo("#screen-meta-links"),$("#tabs,#formfields-select-tabs").tabs({cookie:{expires:60}}).addClass("ui-helper-clearfix"),$("#tabs li").removeClass("ui-corner-top").addClass("ui-corner-left"),$("#tabs li li").removeClass("ui-corner-left"),$("input.menu-item-checkbox[value=intro]").is(":checked")&&$(".wp-editor-textarea").show(),cc_create_slider("#borderwidth","border-width",0,50,1),cc_create_slider("#borderradius","border-radius",0,100,5),cc_create_slider("#paddingwidth","padding",0,100,5),$("body").on("click",".selectall, .selectall input",function(){$(this).select()}).on("ready change","#toggledesign",function(event){console.log("toggledesign change"),event.stopImmediatePropagation(),toggleDesign()}).on("change",'input:checkbox[name^="formfields"]',function(event){event.stopImmediatePropagation(),showHideFormFields($(this)),updateSortOrder(),updateFormFields("change name formfields"),$("textarea.wp-editor").trigger("change")}).on("change","input[name=list_format]",function(event){event.stopImmediatePropagation();var format=$(this).val(),checked="checked";switch(format){case"hidden":checked=null}$('input[name="formfields[lists]"]').attr("checked",checked).trigger("change")}).on("change",'input:checkbox[name^="f"]',function(event){event.stopImmediatePropagation(),updateSortOrder(),updateFormFields("input:checkbox[f] bind")}).on("change keyup","input#bgimage",function(event){event.stopImmediatePropagation(),updateBackgroundURL()}).on("change","#form-fields input.labelValue,#form-fields input.labelDefault",function(event){event.stopImmediatePropagation(),updateFormFields("labelDefault change keyup")}).on("click","li.menu-item .item-edit",function(e){return e.preventDefault(),$(".menu-item-settings",$(this).parents("li.formfield")).toggle(),!1}).on("change","input:not(#examplewrapper input):not(.no-update),select:not(#examplewrapper select):not(.no-update):not(#menu)",function(){$("#cc-form-settings").trigger("stylechange")}).on("click","#togglePreview",function(e){return $("#togglePreview").toggleClass("hidden"),$("#examplewrapper .grabber").toggle(0,function(){$("#examplewrapper .grabber").is(":visible")?($("#cc-form-settings").trigger("stylechange",function(){$("#examplewrapper .legend").show()}),$(window).trigger("resize")):($("#examplewrapper .legend").hide(),$("#examplewrapper").css({width:"0","min-width":"200px"}))}),!1}).on("change","#borderwidth",function(event){kwsdebug&&console.log("#borderwidth change"),event.stopImmediatePropagation(),updateWidthCalculator(),updateBorderWidth(),$(window).trigger("resize")}).on("change",'#tfont,#tsize,input[name="talign"]',function(event){kwsdebug&&console.log('#tfont,#tsize,input[name="talign"] change'),event.stopImmediatePropagation(),updateStyle()}).on("change",'#lfont,#lsize,input[name="lalign"]',function(event){kwsdebug&&console.log('#lfont,#lsize,input[name="lalign"] change'),event.stopImmediatePropagation(),updateLabelStyle()}).on("change","#gradtype",function(event){event.stopImmediatePropagation(),updateBackgroundType("gradtype")}).on("colorchange","#color6,#color2",function(event){event.stopImmediatePropagation(),updateBackgroundType("color6 or color2")}).on("colorchange","#bordercolor",function(event){event.stopImmediatePropagation(),updateBorderColor()}).on("colorchange","#tcolor",function(event){event.stopImmediatePropagation(),updateTextColor()}).on("colorchange","#lcolor",function(event){event.stopImmediatePropagation(),updateLabelColor()}).on("change","#bgpos,#bgrepeat",function(event){event.stopImmediatePropagation(),updateBackgroundURL()}).on("change",'input[name="backgroundtype"]',function(event){event.stopImmediatePropagation(),updateBackgroundType("backgroundtype")}).on("change","input[id^=lus]",function(event){event.stopImmediatePropagation(),updateLabelSame()}).on("click ready","label.labelStyle",function(event){event.stopImmediatePropagation(),$("input[type=checkbox]:checked",$(this)).length>0?$(this).addClass("checked"):$(this).removeClass("checked")}).on("click","ul#patternList li",function(event){event.stopImmediatePropagation(),updatePattern($(this))}).on("change","input[name=widthtype]",function(e){if("per"===$("input[name=widthtype]").val())1*$("#width").val()>100&&($("#width").attr("data-px",$("#width").val()),$("#width").val(100));else{var backup_px=$("#width").attr("data-px");empty(backup_px)||($("#width").val(backup_px),$("#width").attr("data-px",null))}}).on("change keyup","#paddingwidth,input[name=widthtype],#width",function(e){e.stopImmediatePropagation(),(eventKeys(e)||46===e.keyCode||8===e.keyCode)&&updateWidthCalculator()}).on("stylechange","#cc-form-settings",function(event){event.stopImmediatePropagation(),generateForm("stylechange triggered by "+$(event.target).attr("id"))}).on("change","#cc-form-settings input:not(#examplewrapper input):not(.no-update), #cc-form-settings textarea:not(#examplewrapper textarea):not(.no-update), #cc-form-settings select:not(#examplewrapper select):not(.no-update):not(#menu)",function(event){kwsdebug&&console.log("Changed settings input",event),event.stopImmediatePropagation(),generateForm("#cc-form-settings style - "+$(this).attr("id"))}).on("click","label img",function(){$(this).closest("input[type=radio]").click()}).on("click","a.toggleMore",function(){$(this).parents("ul").find(".toggleMore:not(a):not(:has(input[type=checkbox]:checked))").toggle("fast");var text=$(this).text(),text2=text.replace(ScriptParams.labels.show,ScriptParams.labels.hide);return text2===text?$(this).text(text.replace(ScriptParams.labels.hide,ScriptParams.labels.show)):$(this).text(text2),!1}),$("#form-fields").find("ul.menu").sortable({handle:".menu-item-handle",forceHelperSize:!0,placeholder:"sortable-placeholder",start:function(e,ui){updateSharedVars(ui),$(this).disableSelection(),$("body,#menu-to-edit").disableSelection()},change:function(e,ui){ui.placeholder.parent().hasClass("menu")||(prev.length?prev.after(ui.placeholder):api.menuList.prepend(ui.placeholder)),updateSharedVars(ui)},update:function(e,ui){$("body,#menu-to-edit").enableSelection(),$(this).enableSelection(),$("textarea",$(this)).removeAttr("disabled")},sort:function(e,ui){updateSharedVars(ui)},stop:function(e,ui){updateSortOrder(),generateForm("sortable stop")}}),$(".nav-tab-link").click(function(){return panelId=/#(.*)$/.exec($(this).attr("href")),!(!panelId||!panelId[1])&&(panelId=panelId[1],wrapper=$(this).parents(".inside").first(),$(".tabs-panel-active",wrapper).removeClass("tabs-panel-active").addClass("tabs-panel-inactive"),$("#"+panelId,wrapper).removeClass("tabs-panel-inactive").addClass("tabs-panel-active"),$(".tabs",wrapper).removeClass("tabs"),$(this).parent().addClass("tabs"),!1)}),toggleDesign(!0),updateStyle(),showHideFormFields(),sortFieldMenu(),updateFormFields("updateAll"),$("form label.error").hide(),$(window).on("ready resize",function(){if(!$("#examplewrapper .grabber").is(":hidden")){box=jQuery("#menu-management-liquid .menu-edit").width(),menu=jQuery("#menu-to-edit").width(),available=box-menu;var real_width=null;if("px"===$("input[name=widthtype]:checked").val()){var borderwidth=2*$("#borderwidth").val(),paddingwidth=2*$("#paddingwidth").val(),rawwidth=$("#width").val();Math.floor(rawwidth)-Math.floor(paddingwidth)-Math.floor(borderwidth);real_width=Math.floor(rawwidth)+Math.floor(paddingwidth)+Math.floor(borderwidth)}jQuery("#examplewrapper").width(available-60).css("min-width",real_width)}}).trigger("resize"),jQuery(".toggleMore:not(a)").hide()});